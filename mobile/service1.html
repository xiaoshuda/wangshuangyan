<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
    <title>IBM EB-3</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!--jQuery References-->
    
    <script src="js/jquery-1.8.2.min.js" type="text/javascript"></script>
<script type="text/javascript">
/*$(document).bind("pageinit",function(){
	console.log("pageinit");
});
$(document).bind("mobileinit", function() {
　　console.log("Please wait");
});*/
</script>
    <script src="js/jquery.mobile-1.2.0.min.js" type="text/javascript"></script>

    <!--Theme-->
    <link href="css/jquery.mobile-1.3.1.css" rel="stylesheet" type="text/css" title="rocket-jqueryui">
    <link href="css/service1.css" rel="stylesheet" type="text/css">
    <!--Wijmo Widgets CSS-->
    <link href="css/jquery.wijmo-pro.all.3.20131.7.min.css" rel="stylesheet" type="text/css">

    <!--Wijmo Widgets JavaScript-->
    <script src="js/jquery.wijmo-open.all.3.20131.7.min.js" type="text/javascript"></script>
    <script src="js/jquery.wijmo-pro.all.3.20131.7.min.js" type="text/javascript"></script>


</head>
<body>
<div data-role="page" data-theme="c" id="s1" data-mini="true" data-position="fixed">
	<link href="css/grid.css" rel="stylesheet" type="text/css">
            <div data-role="header" data-theme="d" data-position="fixed">
                <a href="index.html" data-ajax="false" data-icon="back">Back</a>
		<h4>客户服务</h4>
            </div>
	<div data-role="content">
		<!-- Begin demo markup -->
		<h4>留言数为Top5的微博内容：</h4>
		<table id="wijgrid">
     		</table>
		<form id="form1">
			<div data-role="fieldcontain">
				<label for="suggest">回复*：</label>
				<textarea cols="60" rows="14" name="suggest" id="suggest" value=""  data-mini="true"  placeholder="请输入您想说的话，我们会时刻关注您的建议..."></textarea>
			</div>	

			
	   <fieldset class="ui-grid-a">
                    <div class="ui-block-a"><button type="reset" data-theme="d" id="reset" data-mini="true">重置</button></div>
                    <div class="ui-block-b"><button data-theme="b" id="submit" data-mini="true">提交</button></div>
            </fieldset>
	</form>
	
	</div>
	   <div data-role="footer" data-theme="d" data-position="fixed">
                <h4>@IBM 深蓝-第3队</h4>
           </div>
<script type="text/javascript">
	$(document).bind("pageinit",function(){
		$(document).bind("pagechange",afterchange);
			
	});
	function afterchange(e,data){	
		/*可用grid数据源**/
		var datasource1 = new wijdatasource({
					proxy: new wijhttpproxy({
						url: "http://9.181.142.107:8082/FinalDemo/AndroidController?flag=service&load=true",
						dataType: "json",
						key: "items"
					}),
					reader: new wijarrayreader([
						{ name: "用户名", mapping: function (item) { return item.nick} },
						
						{ name: "时间", mapping: function (item) { return item.time}  },
						{ name: "微博内容", mapping: function (item) { return item.text}  }
					])
				}); 
		$("#wijgrid").wijgrid({
                		allowSorting: true,
                		allowPaging: true,
               			pageSize: 3,                		
				data: datasource1

            		});
	
		$("#submit").click(function(){
			var content = $("#suggest").val();
			if(content == "")
			{
				alert("请输入内容");
			}else{
			//通过ajax返回数据填充grid
			$.ajax({
				type : "POST",
				url  : "http://9.181.142.107:8082/FinalDemo/AndroidController",
				data : {id:"微博ID",content:"回复内容",flag:'service',load:'false'},
				success : function(data) {
					//alert(data);
					alert("您的信息已提交到我们的数据库，非常感谢您的参与！欢迎下次再来～");
 					$.mobile.changePage( "index.html", { 
							type: "get",
							data: {								
								//location:currentName,
								//flag:'analysis',
								//keyWord:'location',
								load:'false'			
							},
							transition: "slideup"
					     });
				},
				error:function(data){
				alert("error................");
				},
				dataType : "text"
			});
			}
		});	
	}
</script>

</div><!--End Page--->
        
</body>
</html>
